<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OneTime — Lounges</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>
  <div class="bg"></div>

  <header class="fixed-header">
    <div class="header-inner">
      <a class="brand" href="index.html" aria-label="OneTime Home">
        <svg class="logo" width="28" height="28" viewBox="0 0 48 48" aria-hidden="true">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#8bc1ff"/>
              <stop offset="1" stop-color="#6ea8ff"/>
            </linearGradient>
          </defs>
          <rect x="3" y="3" width="42" height="42" rx="10" fill="url(#g)"/>
          <path d="M13 24c0-6 5-11 11-11s11 5 11 11-5 11-11 11-11-5-11-11zm7 0a4 4 0 1 0 8 0a4 4 0 0 0-8 0z" fill="#0f1226" opacity=".9"/>
        </svg>
        <div class="titles">
          <h1>OneTime</h1>
          <div class="tagline">Anonymous • Ephemeral • P2P</div>
        </div>
      </a>
  
      <div class="header-actions">
        <button id="themeToggle" class="btn ghost sm" title="Toggle light/dark mode" aria-pressed="false" aria-label="Toggle theme">
          <svg class="moon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" fill="currentColor"/>
          </svg>
          <svg class="sun" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="12" r="5" fill="currentColor"/>
            <g stroke="currentColor" stroke-width="2" stroke-linecap="round">
              <line x1="12" y1="1" x2="12" y2="4"/>
              <line x1="12" y1="20" x2="12" y2="23"/>
              <line x1="4.22" y1="4.22" x2="6.34" y2="6.34"/>
              <line x1="17.66" y1="17.66" x2="19.78" y2="19.78"/>
              <line x1="1" y1="12" x2="4" y2="12"/>
              <line x1="20" y1="12" x2="23" y2="12"/>
              <line x1="4.22" y1="19.78" x2="6.34" y2="17.66"/>
              <line x1="17.66" y1="6.34" x2="19.78" y2="4.22"/>
            </g>
          </svg>
        </button>
      </div>
    </div>
  </header>    

  <main class="shell">
    <!-- Tabbed Lounge Panel -->
    <section id="loungePanel" class="panel">
      <!-- Tabs (centered) -->
      <nav class="tabbar" role="tablist" aria-label="Lounge options">
        <button id="btnTabBrowse" class="tab active" role="tab" aria-selected="true" aria-controls="paneBrowse">Browse Lounges</button>
        <button id="btnTabCreate" class="tab" role="tab" aria-selected="false" aria-controls="paneCreate">Create a Lounge</button>
        <button id="btnTabJoin" class="tab" role="tab" aria-selected="false" aria-controls="paneJoin">Join a Private Lounge</button>
      </nav>

      <!-- Nickname (global) -->
      <div class="row nameRow" style="justify-content:center; gap:12px; margin-top:12px">
        <label for="nickname" class="label">Nickname</label>
        <input id="nickname" class="input" placeholder="e.g., “Guest”" maxlength="24" style="max-width:260px"/>
        <button id="saveNameBtn" class="btn ghost">Set</button>
      </div>

      <!-- Pane: Browse (default visible) -->
      <section id="paneBrowse" class="tabpane" role="tabpanel" aria-labelledby="btnTabBrowse">
        <div
          class="browse-head"
          style="display:grid;grid-template-columns:1fr auto 1fr;gap:12px;align-items:center;"
        >
          <!-- Left -->
          <h3 style="margin:0">Lounge Directory</h3>
      
          <!-- Center (search) -->
          <input
            id="searchInput"
            class="input"
            placeholder="Search lounges…"
            style="max-width:320px;width:100%;justify-self:center"
          />
      
          <!-- Right (sort) -->
          <div class="row" style="align-items:center;gap:8px;justify-self:end">
            <label class="label" for="sortSelect">Sort</label>
            <select id="sortSelect" class="input" style="max-width:200px">
              <option value="recent">Recent</option>
              <option value="popular">Most Popular</option>
              <option value="online">Most Active</option>
              <option value="az">A–Z</option>
            </select>
          </div>
        </div>
      
        <ul id="loungeList" class="loungeList"></ul>
        <div id="emptyState" class="muted tiny" style="text-align:center; margin-top:8px;">
          No lounges yet. Create one or check back soon.
        </div>
      </section>          

      <!-- Pane: Create -->
      <section id="paneCreate" class="tabpane hidden" role="tabpanel" aria-labelledby="btnTabCreate">
        <h3>Create a Lounge</h3>
        <p class="muted">Pick a name. Choose Public or Private. Private lounges can still be listed, but require a key to join.</p>

        <div class="row" style="margin-top:6px">
          <input id="startName" class="input" placeholder="e.g., chess-club, movie-night" maxlength="40" />
          <button id="startBtn" class="btn primary">Start hosting</button>
        </div>

        <!-- Visibility toggle -->
        <div class="row" style="margin-top:10px; align-items:center">
          <span class="label">Visibility</span>
          <div id="visSeg" class="row" style="gap:8px;">
            <button id="visPublicBtn" class="btn sm primary" type="button" aria-pressed="true">Public</button>
            <button id="visPrivateBtn" class="btn sm ghost" type="button" aria-pressed="false">Private</button>
          </div>
        </div>

        <!-- Private options -->
        <div id="privateKeyWrap" class="row" style="margin-top:8px; align-items:center; gap:10px; display:none;">
          <label class="label">Private key</label>
          <input id="privateKeyValue" class="input" style="max-width:220px" readonly />
          <button id="copyKeyBtn" class="btn sm" type="button">Copy</button>
        </div>

        <div id="showPrivateRow" class="row" style="margin-top:8px; align-items:center; display:none;">
          <input id="showPrivatePublic" type="checkbox" />
          <label for="showPrivatePublic" class="label">Display this private lounge in <em>Browse Lounges</em></label>
        </div>

        <p class="hint tiny" style="margin-top:6px">Public lounges appear automatically. Private lounges marked for display show a <strong>Private</strong> tag in Browse and still require a key to join.</p>
      </section>

      <!-- Pane: Join Private -->
      <section id="paneJoin" class="tabpane hidden" role="tabpanel" aria-labelledby="btnTabJoin">
        <h3>Join a Private Lounge</h3>
        <p class="muted">Enter the 10-character key.</p>
        <div class="row" style="margin-top:6px">
          <input id="joinKey" class="input" placeholder="Private key" maxlength="24" style="max-width:220px" />
          <button id="joinBtn" class="btn">Join</button>
        </div>
      </section>
    </section>

    <!-- Chat -->
    <section id="chat" class="chat hidden" aria-live="polite">
      <div class="chatHeader">
        <div class="left">
          <span class="dot live" id="connDot"></span>
          <span id="roomStatus">Not connected</span>
        </div>
        <div class="right">
          <!-- key chip gets injected here (JS) -->
          <button id="leaveBtn" class="btn danger sm">Leave</button>
        </div>
      </div>

      <ul id="messages" class="messages" role="log"></ul>

      <form id="composer" class="composer" autocomplete="off">
        <input id="msgInput" class="input" placeholder="Type a message…" />
        <button class="btn primary" id="sendBtn" type="submit">Send</button>
      </form>
    </section>

    <footer class="foot">
      <p class="muted tiny">
        Directory persists (public & opted-in private entries). Messages are never stored by the server.
      </p>
    </footer>
  </main>

  <template id="msgTemplate">
    <li class="msg">
      <div class="bubble">
        <div class="meta">
          <span class="from"></span>
          <span class="time"></span>
        </div>
        <div class="text"></div>
      </div>
    </li>
  </template>

  <script src="lounge.js" defer></script>
  <script src="theme.js" defer></script>
</body>
</html>